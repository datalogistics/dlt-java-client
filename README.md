# Data Logistics Toolkit (JAVA Client)

## Introduction
The following sections describe the Data Logistics Toolkit's JAVA client and its main components. This README is targeted towards future developers/programmers of the DLT project. I hope it gets you quick-started and answers most of the questions that come up during the course of the development. Please keep this artifact updated with the future developments on the project.  

## Components
1. Uploader/Downloader Client
   
   .form files are generated using NetBeans IDE that allows visual WYSIWYG editing of UI components. It advisable to change the UI components' graphic properties using NetBeans only, and not alter the initComponents() method that is auto-generated by NetBeans from the .form files.

* [UploadDownloadFrame](./src/edu/crest/dlt/ui/main/UploadDownloadFrame.java) - contains the main() method and is the launcher class for the DLT client

* [CommandLineOptionParser](./src/edu/crest/dlt/ui/utils/CommandLineOptionParser.java) - parses the command line inputs to the client; currently accepts local .xnd (XML encoded exnode), .uef (JSON encoded exnode) files or UNIS URL's to exnodes

* FilesPanel - displays the names of files available for transfer ([download](./src/edu/crest/dlt/ui/down/FilesPanel.java) / [upload](./src/edu/crest/dlt/ui/up/FilesPanel.java))

* TransferSettingsPanel - allows the user to select the preferred settings for performing the transfer
  * [download](./src/edu/crest/dlt/ui/down/TransferSettingsPanel.java)
  * [upload](./src/edu/crest/dlt/ui/up/TransferSettingsPanel.java) - list of depots is requested from LBone server (may be replaced by some other discovery service in the future), based on the pre-configured locations and lbone server settings in [config.properties](./src/edu/crest/dlt/utils/config.properties "DLT client configuration file"), at UI load time; all depots known to the client are stored in a static List of depots with (attempted) connection pools and are displayed to the user to choose from for publishing their content

* [TransferProgressPanel](./src/edu/crest/dlt/ui/utils/TransferProgressPanel.java) - shows runtime progress of the ongoing transfer (upload/download)

2. [Exnode](./src/edu/crest/dlt/exnode/Exnode.java)
* the downloader obtains metadata from the XML or JSON serialized object and constructs an exnode for downloading contents of the file; the uploader creates an exnode with the specified filename and populates its metadata as the upload/publish progresses
* is a metadata-container containing metadata related to the mappings of a file hosted on the DLT network
* maintains a queue of transfer jobs
* maintains a list of transfer threads/workers

3. [Allocation](./src/dlt-client/src/edu/crest/dlt/ibp/Allocation.java)
* an allocation represents a chunk (offset, length in bytes) of a file's content hosted on a depot with one or more [capabilities](./src/dlt-client/src/edu/crest/dlt/ibp/Capability.java) (Read/Write/Manage)

4. [Mapping](./src/dlt-client/src/edu/crest/dlt/exnode/Mapping.java)
* a mapping represents an allocation replicated on one (i.e. no replication) or more (typically 3) distinct depots. Replicas of the same mapping have the same offset and length but different depots
* even one of the mappings corresponding to the same offset is accessible, that chunk can be downloaded

5. [Depot](./src/dlt-client/src/edu/crest/dlt/ibp/Depot.java)
* a depot (i.e. an IBP depot) represents an IBP storage-retrieval service
* maintains a static set of available depots currently known to the client
* maintains a pool of connections to the IBP server - the connection/socket pool is initialized when the Depot object is created and is released when the object gets destroyed/finalized

6. File [Read](./src/dlt-client/src/edu/crest/dlt/bd/diskio/FileReadThread.java)/[Write](./src/dlt-client/src/edu/crest/dlt/bd/diskio/FileWriteThread.java) Threads
* singleton thread for performing read/write from/to a file's content
* A ReadJob, buffers data received from a depot, then the ReadThread submits the ReadJob to the FileWriteThread - an exnode read operation completes successfully only after all the received data has been written out to disk
* A WriteThread requests data from disk by submitting a WriteJob to the FileReadThread - a WriteJob can be performed only after its data has been buffered (#ThanksForStatingTheObvious!!! #Chuckles)

7. Transfer ([Read](./src/dlt-client/src/edu/crest/dlt/transfer/ReadThread.java)/[Write](./src/dlt-client/src/edu/crest/dlt/transfer/WriteThread.java)) Threads
* A ReadThread understands the states of a ReadJob and makes necessary decisions based on a ReadJob's current state
* A WriteThread understands the states of a WriteJob and makes necessary decisions based on a WriteJob's current state

8. Transfer ([Read](./src/dlt-client/src/edu/crest/dlt/transfer/ReadJob.java)/[Write](./src/dlt-client/src/edu/crest/dlt/transfer/WriteJob.java)) Jobs
* ReadJobs targeting the same mappings hold references to the same list of mappings that is used as a MaxHeap (max meaning the best mapping for performing the next ReadJob)(this part is experimental and may not be too useful - I assume it still performs better than scanning through the entire (typically size=3) list of mappings at little to no additional overhead)
* A WriteJob with buffered data keeps the data buffered until it either succeeds in making the desired number of copies/replicas (allocations) or causes the exnode's write operation to fail

## Development Tools
1. [Eclipse IDE](<https://www.eclipse.org/downloads/> "Download Eclipse") - Backend.

   Eclipse was used for the convenience of writing the business logic of the DLT client
3. [NetBeans IDE](<https://netbeans.org/downloads/> "Download NetBeans") - Frontend/UI

   The frontend/UI was developed using NetBeans for its simplicity and short learning curve. Display related properties of UI components must be edited using NetBeans (so refrain from making changes to the parts of UI code marked as auto-generated).

## Configure
Configuration settings for most of the client initialization and runtime configurations and behavior can be found in the [config.properties](./src/edu/crest/dlt/utils/config.properties "DLT client configuration file") file.

## Downloader
###

## Uploader
###